<!doctype html>
<html>
  <head>
    <title>PhonePe Test Payment</title>
  </head>
  <body>
    <h2>PhonePe Test Payment</h2>
    <button id="payBtn">Pay Now</button>

    <script>
      document.getElementById("payBtn").addEventListener("click", async () => {
        try {
          // Step 1: Call your backend to create the PhonePe order
          const res = await fetch("/api/v1/create-order", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
              authorization:
                "Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VySWQiOiI2ODY2YjU1ZGYwY2NiNzNlNGRiNmU4MTkiLCJpYXQiOjE3NTQ2NjQ5NjQsImV4cCI6MTc1NTI2OTc2NH0.7QLqMAbzOJ_VUEV2FQJfnvzDwcBASBIBilhPRnNO15E",
            },
            body: JSON.stringify({
              productIds: ["6868a9ce68b03371cc9e07e3"],
            }),
          });

          const data = await res.json();
          console.log("Order creation response:", data);
          if (data.status === 200) {
            if (data?.data?.checkoutPageUrl) {
              window.location.href = data.data.checkoutPageUrl;
            } else {
              alert("Failed to initiate payment");
            }
          } else {
            alert("Failed to create order");
          }
        } catch (err) {
          console.error("Error creating order:", err);
          alert("Something went wrong.");
        }
      });
    </script>
  </body>
</html>
